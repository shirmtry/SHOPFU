<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üõí Premium Tools & Services</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root {
    --primary: #4361ee;
    --secondary: #3f37c9;
    --accent: #4895ef;
    --success: #4cc9f0;
    --danger: #f72585;
    --warning: #f8961e;
    --light: #f8f9fa;
    --dark: #212529;
    --gray: #6c757d;
    --white: #ffffff;
    --gradient: linear-gradient(135deg, #4361ee 0%, #3f37c9 100%);
    --shadow: 0 10px 20px rgba(0,0,0,0.1);
    --shadow-hover: 0 15px 30px rgba(0,0,0,0.2);
    --radius: 12px;
    --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
    color: var(--dark);
    min-height: 100vh;
    overflow-x: hidden;
  }

  header {
    background: var(--gradient);
    color: var(--white);
    padding: 1.5rem 2rem;
    text-align: center;
    font-family: 'Montserrat', sans-serif;
    font-size: 1.8rem;
    font-weight: 700;
    letter-spacing: 1px;
    box-shadow: var(--shadow);
    position: relative;
    overflow: hidden;
  }

  .user-panel {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    gap: 1.5rem;
    margin: 2rem auto;
    max-width: 1200px;
    padding: 0 1rem;
  }

  .user-card {
    background: var(--white);
    border-radius: var(--radius);
    padding: 1.2rem 2rem;
    box-shadow: var(--shadow);
    display: flex;
    align-items: center;
    gap: 1rem;
    transition: var(--transition);
  }

  .user-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-hover);
  }

  .user-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: var(--gradient);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--white);
    font-size: 1.2rem;
    font-weight: 600;
  }

  .user-info {
    display: flex;
    flex-direction: column;
  }

  .user-name {
    font-weight: 600;
    color: var(--dark);
    font-size: 1.1rem;
  }

  .user-balance {
    font-size: 1rem;
    color: var(--gray);
  }

  .balance-amount {
    color: var(--success);
    font-weight: 600;
  }

  .action-buttons {
    display: flex;
    gap: 1rem;
  }

  .btn {
    padding: 0.8rem 1.5rem;
    border-radius: 50px;
    font-weight: 600;
    font-size: 0.9rem;
    cursor: pointer;
    transition: var(--transition);
    border: none;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .btn-primary {
    background: var(--gradient);
    color: var(--white);
  }

  .btn-primary:hover {
    background: linear-gradient(135deg, #3a56d4 0%, #372eb3 100%);
    transform: translateY(-2px);
  }

  .btn-secondary {
    background: var(--light);
    color: var(--dark);
    border: 1px solid #dee2e6;
  }

  .btn-secondary:hover {
    background: #e9ecef;
    transform: translateY(-2px);
  }

  .shop-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 1rem;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 2rem;
  }

  .package-card {
    background: var(--white);
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow);
    transition: var(--transition);
    display: flex;
    flex-direction: column;
  }

  .package-card:hover {
    transform: translateY(-10px);
    box-shadow: var(--shadow-hover);
  }

  .package-header {
    background: var(--gradient);
    color: var(--white);
    padding: 1.5rem;
    text-align: center;
    position: relative;
    overflow: hidden;
  }

  .package-title {
    font-family: 'Montserrat', sans-serif;
    font-size: 1.3rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
  }

  .package-icon {
    font-size: 3rem;
    margin: 1rem 0;
    color: rgba(255,255,255,0.9);
  }

  .package-body {
    padding: 1.5rem;
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .package-price {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--danger);
    text-align: center;
    margin-bottom: 1.5rem;
  }

  .price-period {
    font-size: 0.9rem;
    color: var(--gray);
    font-weight: 400;
  }

  .package-features {
    margin-bottom: 1.5rem;
    flex: 1;
  }

  .feature-item {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    margin-bottom: 0.8rem;
    font-size: 0.95rem;
    color: var(--dark);
  }

  .feature-item i {
    color: var(--accent);
    margin-top: 0.2rem;
    font-size: 0.8rem;
  }

  .package-footer {
    margin-top: auto;
  }

  .btn-buy {
    width: 100%;
    padding: 1rem;
    background: var(--gradient);
    color: var(--white);
    border: none;
    border-radius: 0 0 var(--radius) var(--radius);
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
  }

  .btn-buy:hover {
    background: linear-gradient(135deg, #3a56d4 0%, #372eb3 100%);
  }

  .btn-buy i {
    font-size: 1.1rem;
  }

  .loading-container {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 200px;
  }

  .spinner {
    width: 50px;
    height: 50px;
    border: 5px solid rgba(67, 97, 238, 0.2);
    border-radius: 50%;
    border-top-color: var(--primary);
    animation: spin 1s ease-in-out infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .notification {
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--white);
    padding: 1rem 1.5rem;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    display: flex;
    align-items: center;
    gap: 1rem;
    transform: translateX(150%);
    transition: var(--transition);
    z-index: 1000;
  }

  .notification.show {
    transform: translateX(0);
  }

  .notification.success {
    border-left: 4px solid var(--success);
  }

  .notification.error {
    border-left: 4px solid var(--danger);
  }

  .notification-icon {
    font-size: 1.5rem;
  }

  .success .notification-icon {
    color: var(--success);
  }

  .error .notification-icon {
    color: var(--danger);
  }

  .notification-content h4 {
    font-size: 1rem;
    margin-bottom: 0.3rem;
  }

  .notification-content p {
    font-size: 0.9rem;
    color: var(--gray);
  }

  footer {
    background: var(--dark);
    color: var(--light);
    text-align: center;
    padding: 2rem;
    margin-top: 3rem;
  }

  .footer-content {
    max-width: 1200px;
    margin: 0 auto;
  }

  .footer-links {
    display: flex;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 1.5rem;
  }

  .footer-link {
    color: var(--light);
    text-decoration: none;
    transition: var(--transition);
  }

  .footer-link:hover {
    color: var(--accent);
  }

  .copyright {
    font-size: 0.9rem;
    color: var(--gray);
  }

  @media (max-width: 768px) {
    header {
      font-size: 1.5rem;
      padding: 1.2rem;
    }

    .user-panel {
      flex-direction: column;
      gap: 1rem;
    }

    .user-card {
      width: 100%;
      justify-content: center;
    }

    .action-buttons {
      width: 100%;
      justify-content: center;
    }

    .shop-container {
      grid-template-columns: 1fr;
    }

    .footer-links {
      flex-direction: column;
      gap: 1rem;
      align-items: center;
    }
  }
</style>
</head>
<body>

<header>
  <i class="fas fa-crown"></i> PREMIUM TOOLS & SERVICES
</header>

<div class="user-panel">
  <div class="user-card">
    <div class="user-avatar" id="user-avatar">U</div>
    <div class="user-info">
      <div class="user-name" id="username">ƒêang t·∫£i...</div>
      <div class="user-balance">S·ªë d∆∞: <span class="balance-amount" id="balance">0</span> VND</div>
    </div>
  </div>
  <div class="action-buttons">
    <button class="btn btn-primary" id="btn-deposit">
      <i class="fas fa-coins"></i> N·∫°p ti·ªÅn
    </button>
    <button class="btn btn-secondary" id="btn-logout">
      <i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t
    </button>
  </div>
</div>

<div class="shop-container" id="shop">
  <div class="loading-container">
    <div class="spinner"></div>
  </div>
</div>

<div class="notification" id="notification">
  <div class="notification-icon">
    <i class="fas fa-check-circle"></i>
  </div>
  <div class="notification-content">
    <h4 id="notification-title">Th√†nh c√¥ng</h4>
    <p id="notification-message">Thao t√°c ƒë√£ ƒë∆∞·ª£c th·ª±c hi·ªán</p>
  </div>
</div>

<footer>
  <div class="footer-content">
    <div class="footer-links">
      <a href="#" class="footer-link">ƒêi·ªÅu kho·∫£n d·ªãch v·ª•</a>
      <a href="#" class="footer-link">Ch√≠nh s√°ch b·∫£o m·∫≠t</a>
      <a href="#" class="footer-link">H·ªó tr·ª£</a>
      <a href="#" class="footer-link">Li√™n h·ªá</a>
    </div>
    <div class="copyright">
      &copy; 2025 Premium Tools & Services. All rights reserved.
    </div>
  </div>
</footer>

<script>
  // Google Apps Script Web App URL - REPLACE WITH YOUR OWN
  const API_URL = "https://script.google.com/macros/s/AKfycby-wQER7OQWR2WYTRqwjhHXa7IrrW8V8IqhPBe3eJMpguEor1myIwoXs0HSIeDFt1elEg/exec";
  
  // User data
  let userData = {
    name: "",
    balance: 0,
    avatar: "U"
  };

  // DOM elements
  const shopContainer = document.getElementById('shop');
  const usernameElement = document.getElementById('username');
  const balanceElement = document.getElementById('balance');
  const userAvatarElement = document.getElementById('user-avatar');
  const btnDeposit = document.getElementById('btn-deposit');
  const btnLogout = document.getElementById('btn-logout');
  const notification = document.getElementById('notification');

  // Product data
  const packages = [
    {
      name: "G√≥i Basic", 
      icon: "fas fa-laptop-code",
      price: 400000, 
      code: "basic", 
      period: "1 th√°ng",
      features: [
        "TOOL SEB b·∫£n c∆° b·∫£n",
        "S·ª≠ d·ª•ng 1 thi·∫øt b·ªã",
        "H·ªó tr·ª£ 24/7 qua chat",
        "C·∫≠p nh·∫≠t h√†ng tu·∫ßn",
        "B·∫£o h√†nh 7 ng√†y"
      ]
    },
    {
      name: "G√≥i VIP1", 
      icon: "fas fa-rocket",
      price: 600000, 
      code: "vip1", 
      period: "3 th√°ng",
      features: [
        "TOOL EOS cao c·∫•p",
        "S·ª≠ d·ª•ng 1 thi·∫øt b·ªã",
        "Update mi·ªÖn ph√≠ li√™n t·ª•c",
        "H·ªó tr·ª£ t·ª´ xa",
        "B·∫£o h√†nh 30 ng√†y"
      ]
    },
    {
      name: "G√≥i VIP2", 
      icon: "fas fa-bolt",
      price: 800000, 
      code: "vip2", 
      period: "6 th√°ng",
      features: [
        "TOOL EOS + SEB PRO",
        "D√πng ƒë∆∞·ª£c 1 k√¨ h·ªçc",
        "H·ªó tr·ª£ t·ª´ xa 24/7",
        "∆Øu ti√™n c·∫≠p nh·∫≠t",
        "B·∫£o h√†nh 60 ng√†y"
      ]
    },
    {
      name: "G√≥i VIP3", 
      icon: "fas fa-crown",
      price: 3000000, 
      code: "vip3", 
      period: "4 nƒÉm",
      features: [
        "TOOL EOS + SEB PRO MAX",
        "D√πng ƒë∆∞·ª£c 4 nƒÉm",
        "H·ªó tr·ª£ VIP 24/7",
        "C·∫≠p nh·∫≠t real-time",
        "B·∫£o h√†nh tr·ªçn ƒë·ªùi"
      ]
    },
    {
      name: "G√≥i Support", 
      icon: "fas fa-hands-helping",
      price: 50000, 
      code: "support", 
      period: "1 l·∫ßn",
      features: [
        "H·ªó tr·ª£ k·ªπ thu·∫≠t chuy√™n s√¢u",
        "C√†i ƒë·∫∑t tool t·ª´ xa",
        "T∆∞ v·∫•n t·ªëi ∆∞u b·∫£o m·∫≠t",
        "Fix l·ªói nhanh ch√≥ng",
        "H∆∞·ªõng d·∫´n chi ti·∫øt"
      ]
    },
    {
      name: "App Banking ·∫¢o", 
      icon: "fas fa-university",
      price: 500000, 
      code: "fakebill", 
      period: "Vƒ©nh vi·ªÖn",
      features: [
        "Fake bill chuy·ªÉn kho·∫£n",
        "H·ªó tr·ª£ 20+ ng√¢n h√†ng",
        "Giao di·ªán gi·ªëng th·∫≠t 99%",
        "T√πy ch·ªânh th√¥ng tin",
        "Kh√¥ng l∆∞u d·ªØ li·ªáu"
      ]
    },
    {
      name: "G√≥i B·∫£o M·∫≠t", 
      icon: "fas fa-shield-alt",
      price: 250000, 
      code: "security", 
      period: "6 th√°ng",
      features: [
        "Ch·ªëng b·ªã ph√°t hi·ªán tool",
        "·∫®n IP v√† th√¥ng tin thi·∫øt b·ªã",
        "C·∫≠p nh·∫≠t li√™n t·ª•c",
        "B·∫£o v·ªá real-time",
        "H·ªó tr·ª£ 24/7"
      ]
    }
  ];

  // Initialize the page
  document.addEventListener('DOMContentLoaded', async () => {
    // Check authentication
    await checkAuth();
    
    // Load user data
    await loadUserData();
    
    // Render shop
    renderShop();
    
    // Setup event listeners
    setupEventListeners();
  });

  // Check if user is authenticated
  async function checkAuth() {
    const username = localStorage.getItem('username');
    if (!username) {
      showNotification('error', 'L·ªói ƒëƒÉng nh·∫≠p', 'Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ ti·∫øp t·ª•c');
      setTimeout(() => {
        window.location.href = 'login.html';
      }, 1500);
      return false;
    }
    return true;
  }

  // Load user data from Google Apps Script
  async function loadUserData() {
    try {
      const username = localStorage.getItem('username');
      if (!username) {
        await checkAuth();
        return;
      }
      
      // Show loading state
      usernameElement.textContent = 'ƒêang t·∫£i...';
      balanceElement.textContent = '0';
      
      // Fetch user data from Google Apps Script
      const response = await fetch(`${API_URL}?action=getUser&username=${encodeURIComponent(username)}`);
      
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      
      const data = await response.json();
      
      if (data.success) {
        userData = {
          name: data.name || username,
          balance: parseInt(data.balance) || 0,
          avatar: data.name ? data.name.charAt(0).toUpperCase() : username.charAt(0).toUpperCase()
        };
        
        // Update UI
        updateUserUI();
      } else {
        throw new Error(data.message || 'Failed to load user data');
      }
    } catch (error) {
      console.error('Failed to load user data:', error);
      showNotification('error', 'L·ªói', 'Kh√¥ng th·ªÉ t·∫£i th√¥ng tin ng∆∞·ªùi d√πng');
      usernameElement.textContent = localStorage.getItem('username') || 'Kh√°ch';
      balanceElement.textContent = '0';
    }
  }

  // Update user UI elements
  function updateUserUI() {
    usernameElement.textContent = userData.name;
    balanceElement.textContent = userData.balance.toLocaleString('vi-VN');
    userAvatarElement.textContent = userData.avatar;
  }

  // Render shop products
  function renderShop() {
    shopContainer.innerHTML = '';
    
    if (packages.length === 0) {
      shopContainer.innerHTML = `
        <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
          <i class="fas fa-box-open" style="font-size: 3rem; color: var(--gray); margin-bottom: 1rem;"></i>
          <h3 style="color: var(--gray);">Hi·ªán kh√¥ng c√≥ s·∫£n ph·∫©m n√†o</h3>
        </div>
      `;
      return;
    }
    
    packages.forEach(pkg => {
      const featuresHtml = pkg.features.map(feature => `
        <div class="feature-item">
          <i class="fas fa-check-circle"></i>
          <span>${feature}</span>
        </div>
      `).join('');
      
      const packageElement = document.createElement('div');
      packageElement.className = 'package-card';
      packageElement.innerHTML = `
        <div class="package-header">
          <div class="package-icon">
            <i class="${pkg.icon}"></i>
          </div>
          <h3 class="package-title">${pkg.name}</h3>
        </div>
        <div class="package-body">
          <div class="package-price">
            ${pkg.price.toLocaleString('vi-VN')} VND
            <div class="price-period">${pkg.period}</div>
          </div>
          <div class="package-features">
            ${featuresHtml}
          </div>
          <div class="package-footer">
            <button class="btn-buy" data-price="${pkg.price}" data-package="${pkg.code}">
              <i class="fas fa-shopping-cart"></i> Mua ngay
            </button>
          </div>
        </div>
      `;
      
      shopContainer.appendChild(packageElement);
    });
    
    // Add event listeners to buy buttons
    document.querySelectorAll('.btn-buy').forEach(btn => {
      btn.addEventListener('click', handleBuyClick);
    });
  }

  // Handle buy button click
  async function handleBuyClick() {
    const price = parseInt(this.getAttribute('data-price'));
    const packageCode = this.getAttribute('data-package');
    const packageName = packages.find(pkg => pkg.code === packageCode)?.name || 's·∫£n ph·∫©m';
    
    if (userData.balance >= price) {
      try {
        // Process purchase via Google Apps Script
        const username = localStorage.getItem('username');
        const response = await fetch(API_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
          },
          body: `action=purchase&username=${encodeURIComponent(username)}&package=${encodeURIComponent(packageCode)}&amount=${price}`
        });
        
        const data = await response.json();
        
        if (data.success) {
          // Update local balance
          userData.balance -= price;
          updateUserUI();
          
          showNotification('success', 'Mua th√†nh c√¥ng', `B·∫°n ƒë√£ mua ${packageName} v·ªõi gi√° ${price.toLocaleString('vi-VN')} VND`);
          
          // Redirect to thank you page
          setTimeout(() => {
            window.location.href = `thankyou.html?package=${packageCode}`;
          }, 2000);
        } else {
          throw new Error(data.message || 'Purchase failed');
        }
      } catch (error) {
        console.error('Purchase error:', error);
        showNotification('error', 'L·ªói', 'Kh√¥ng th·ªÉ ho√†n t·∫•t giao d·ªãch');
      }
    } else {
      const needed = price - userData.balance;
      showNotification('error', 'S·ªë d∆∞ kh√¥ng ƒë·ªß', `B·∫°n c·∫ßn n·∫°p th√™m ${needed.toLocaleString('vi-VN')} VND ƒë·ªÉ mua g√≥i n√†y`);
      
      // Focus on deposit button
      btnDeposit.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
  }

  // Show notification
  function showNotification(type, title, message) {
    const notificationTitle = document.getElementById('notification-title');
    const notificationMessage = document.getElementById('notification-message');
    const notificationIcon = notification.querySelector('.notification-icon i');
    
    // Set content
    notificationTitle.textContent = title;
    notificationMessage.textContent = message;
    
    // Set style based on type
    notification.className = 'notification';
    notification.classList.add(type);
    
    // Set icon based on type
    if (type === 'success') {
      notificationIcon.className = 'fas fa-check-circle';
    } else {
      notificationIcon.className = 'fas fa-exclamation-circle';
    }
    
    // Show notification
    notification.classList.add('show');
    
    // Hide after 5 seconds
    setTimeout(() => {
      notification.classList.remove('show');
    }, 5000);
  }

  // Setup event listeners
  function setupEventListeners() {
    // Deposit button
    btnDeposit.addEventListener('click', () => {
      window.location.href = 'deposit.html';
    });
    
    // Logout button
    btnLogout.addEventListener('click', () => {
      localStorage.removeItem('username');
      localStorage.removeItem('authToken');
      window.location.href = 'login.html';
    });
  }
</script>

</body>
</html>
