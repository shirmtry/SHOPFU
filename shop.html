<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOOL Shop</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a0ca3;
            --accent-color: #f72585;
            --dark-color: #212529;
            --light-color: #f8f9fa;
            --success-color: #4cc9f0;
        }
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #000428, #004e92);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--light-color);
        }
        .main-container { width: 90%; max-width: 800px; margin: 2rem auto; }
        .header { text-align: center; margin-bottom: 2rem; }
        .header h1 {
            font-size: 2.5rem; margin: 0;
            background: linear-gradient(to right, #f72585, #4361ee);
            -webkit-background-clip: text; background-clip: text; color: transparent;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .user-info {
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 10px;
            margin-bottom: 1.5rem; backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .user-greeting { font-size: 1.2rem; font-weight: 600; }
        .user-greeting span { color: var(--accent-color); }
        .user-balance {
            background: rgba(0, 0, 0, 0.3); padding: 0.5rem 1rem; border-radius: 20px;
            font-weight: 600;
        }
        .products-container {
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px);
            border-radius: 15px; padding: 2rem; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .section-title { font-size: 1.5rem; margin-bottom: 1.5rem; color: var(--light-color); display: flex; align-items: center; }
        .section-title i { margin-right: 10px; color: var(--accent-color); }
        .product-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;
        }
        .product-card {
            background: linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
            border-radius: 12px; padding: 1.5rem; transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1); position: relative; overflow: hidden;
        }
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); border-color: rgba(255, 255, 255, 0.3); }
        .product-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.05), transparent); z-index: 0;
        }
        .product-name { font-size: 1.3rem; font-weight: 700; margin-bottom: 0.5rem; position: relative; color: white; }
        .product-features { list-style-type: none; padding: 0; margin: 1rem 0; font-size: 0.9rem; }
        .product-features li { margin-bottom: 0.5rem; display: flex; align-items: center; }
        .product-features li::before { content: '✓'; color: var(--success-color); margin-right: 8px; font-weight: bold; }
        .product-price { font-size: 1.8rem; font-weight: 700; margin: 1.5rem 0; color: var(--accent-color); text-align: center; }
        .btn-select {
            width: 100%; padding: 12px; border: none; border-radius: 8px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white; font-weight: 600; cursor: pointer; transition: all 0.3s ease;
            display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden;
        }
        .btn-select:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(67, 97, 238, 0.4); }
        .btn-select:active { transform: translateY(0); }
        .btn-select i { margin-right: 8px; }
        .note-box {
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border-radius: 10px;
            padding: 1.5rem; margin-top: 2rem; text-align: center; font-size: 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .payment-methods { display: flex; justify-content: center; gap: 15px; margin-top: 1rem; }
        .payment-method { width: 40px; height: 25px; object-fit: contain; filter: grayscale(100%) brightness(2); transition: filter 0.3s; }
        .payment-method:hover { filter: grayscale(0) brightness(1); }
        @media (max-width: 768px) {
            .main-container { width: 95%; }
            .product-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="header">
            <h1>PREMIUM TOOL SHOP</h1>
        </div>
        <div class="user-info" id="user-info">
            <div class="user-greeting" id="user-greeting">Đang tải...</div>
            <div class="user-balance" id="user-balance">
                <i class="fas fa-wallet"></i> Đang tải...
            </div>
        </div>
        <div class="products-container">
            <h2 class="section-title"><i class="fas fa-crown"></i> GÓI DỊCH VỤ CAO CẤP</h2>
            <div class="product-grid">
                <div class="product-card">
                    <h3 class="product-name">TOOL SEB</h3>
                    <ul class="product-features">
                        <li>Auto chụp </li>
                        <li>Auto giải</li>
                        <li>Auto khoanh</li>
                        <li>Hỗ trợ 24/7</li>
                    </ul>
                    <div class="product-price">400.000 VND</div>
                    <button class="btn-select" data-price="400000">
                        <i class="fas fa-shopping-cart"></i> Gói Basic
                    </button>
                </div>
                <div class="product-card">
                    <h3 class="product-name">TOOL EOS</h3>
                    <ul class="product-features">
                        <li>Auto chụp </li>
                        <li>Auto giải</li>
                        <li>Auto khoanh</li>
                        <li>Hỗ trợ 24/7</li>
                    </ul>
                    <div class="product-price">600.000 VND</div>
                    <button class="btn-select" data-price="600000">
                        <i class="fas fa-shopping-cart"></i> Gói VIP1
                    </button>
                </div>
                <div class="product-card">
                    <h3 class="product-name">TOOL EOS + SEB</h3>
                    <ul class="product-features">
                        <li>Auto chụp </li>
                        <li>Auto giải</li>
                        <li>Auto khoanh</li>
                        <li>Bản quyền 1 kì</li>
                    </ul>
                    <div class="product-price">800.000 VND</div>
                    <button class="btn-select" data-price="800000">
                        <i class="fas fa-gem"></i> GÓI VIP2
                    </button>
                </div>
                <div class="product-card">
                    <h3 class="product-name">TOOL EOS + SEB</h3>
                    <ul class="product-features">
                        <li>Tất cả tính năng EOS & SEB</li>
                        <li>Tính năng độc quyền</li>
                        <li>Hỗ trợ VIP 1-1</li>
                        <li>Bản quyền vĩnh viễn</li>
                    </ul>
                    <div class="product-price">3.000.000 VND</div>
                    <button class="btn-select" data-price="3000000">
                        <i class="fas fa-gem"></i> GÓI VIP3
                    </button>
                </div>
            </div>
        </div>
        <div class="note-box">
            <p>Sau khi chọn gói, hệ thống sẽ chuyển đến trang thanh toán qua QR Code</p>
        </div>
    </div>
    <!-- Script lấy dữ liệu user từ Google Sheet qua API Apps Script -->
    <script>
        // Lấy username từ localStorage (lưu khi đăng nhập)
        const username = localStorage.getItem("username");
        if (!username) {
            // Nếu chưa đăng nhập, chuyển hướng về trang đăng nhập
            window.location.href = "login.html";
        }

        const apiLink = 'https://script.google.com/macros/s/AKfycbwN58CHkEBXBUe7xc8QXeRni1ijt95Y8HObzB2q04wVM1z8Ve0gev-xnPOrLNG_SB6yYg/exec';

        function loadUserInfo() {
            fetch(apiLink + '?action=getUser&username=' + encodeURIComponent(username))
                .then(res => res.json())
                .then(data => {
                    if (data.error && data.error === "User not found") {
                        // Nếu chưa có user thì tạo tài khoản mới
                        fetch(apiLink + '?action=createUser&username=' + encodeURIComponent(username))
                            .then(res => res.json())
                            .then(newData => {
                                if (newData.error) {
                                    document.getElementById('user-greeting').innerHTML = `<span style="color:red">${newData.error}</span>`;
                                    document.getElementById('user-balance').innerHTML = '';
                                } else {
                                    document.getElementById('user-greeting').innerHTML = `Xin chào, <span>${newData.username}</span>!`;
                                    document.getElementById('user-balance').innerHTML = `<i class="fas fa-wallet"></i> Số dư: 0 VND`;
                                }
                            })
                            .catch(e => {
                                document.getElementById('user-greeting').innerHTML = `<span style="color:red">Lỗi tạo user!</span>`;
                                document.getElementById('user-balance').innerHTML = '';
                            });
                    } else if (data.error) {
                        document.getElementById('user-greeting').innerHTML = `<span style="color:red">${data.error}</span>`;
                        document.getElementById('user-balance').innerHTML = '';
                    } else {
                        document.getElementById('user-greeting').innerHTML = `Xin chào, <span>${data.username}</span>!`;
                        document.getElementById('user-balance').innerHTML = `<i class="fas fa-wallet"></i> Số dư: ${Number(data.balance).toLocaleString('vi-VN')} VND`;
                    }
                })
                .catch(e => {
                    document.getElementById('user-greeting').innerHTML = `<span style="color:red">Lỗi kết nối API</span>`;
                    document.getElementById('user-balance').innerHTML = '';
                });
        }
        loadUserInfo();
    </script>
    <script>
        document.querySelectorAll('.btn-select').forEach(button => {
            button.addEventListener('click', function() {
                const productName = this.parentElement.querySelector('.product-name').textContent;
                const productPrice = this.getAttribute('data-price');
                // Hiệu ứng loading
                this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ĐANG XỬ LÝ...';
                this.disabled = true;
                setTimeout(() => {
                    const orderInfo = {
                        name: productName,
                        price: productPrice,
                        formattedPrice: this.parentElement.querySelector('.product-price').textContent,
                        orderCode: `VIP${new Date().getTime().toString().slice(-6)}`
                    };
                    localStorage.setItem('currentOrder', JSON.stringify(orderInfo));
                    window.location.href = 'banking.html';
                }, 1000);
            });
        });
    </script>
    <script>
// --- Thông báo random người mua gói ---

const NAMES = [
    "Nguyễn Văn An","Nguyễn Văn Bình","Nguyễn Văn Cường","Nguyễn Văn Dũng","Nguyễn Văn Đức","Nguyễn Văn Hùng","Nguyễn Văn Khánh","Nguyễn Văn Lâm","Nguyễn Văn Long","Nguyễn Văn Minh",
"Nguyễn Văn Nam","Nguyễn Văn Phát","Nguyễn Văn Phú","Nguyễn Văn Quân","Nguyễn Văn Quang","Nguyễn Văn Sơn","Nguyễn Văn Tài","Nguyễn Văn Thắng","Nguyễn Văn Thành","Nguyễn Văn Toàn",
"Nguyễn Văn Trung","Nguyễn Văn Tuấn","Nguyễn Văn Vinh","Nguyễn Văn Vũ","Nguyễn Văn Việt","Nguyễn Văn Hòa","Nguyễn Văn Kiên","Nguyễn Văn Đạt","Nguyễn Văn Hiếu","Nguyễn Văn Hiệp",
"Nguyễn Văn Hải","Nguyễn Văn Thái","Nguyễn Văn Hạnh","Nguyễn Văn Hảo","Nguyễn Văn Bảo","Nguyễn Văn Phúc","Nguyễn Văn Khoa","Nguyễn Văn Lộc","Nguyễn Văn Thọ","Nguyễn Văn Thành",
"Nguyễn Thị An","Nguyễn Thị Bình","Nguyễn Thị Cúc","Nguyễn Thị Dung","Nguyễn Thị Đào","Nguyễn Thị Hạnh","Nguyễn Thị Hằng","Nguyễn Thị Hoa","Nguyễn Thị Hồng","Nguyễn Thị Huệ",
"Nguyễn Thị Lan","Nguyễn Thị Lý","Nguyễn Thị Mai","Nguyễn Thị Nga","Nguyễn Thị Ngọc","Nguyễn Thị Nhàn","Nguyễn Thị Nhung","Nguyễn Thị Phương","Nguyễn Thị Quỳnh","Nguyễn Thị Thảo",
"Nguyễn Thị Thu","Nguyễn Thị Thủy","Nguyễn Thị Tuyết","Nguyễn Thị Vân","Nguyễn Thị Yến","Nguyễn Thị Hương","Nguyễn Thị Tâm","Nguyễn Thị Thanh","Nguyễn Thị Trinh","Nguyễn Thị Trúc",
"Trần Văn An","Trần Văn Bình","Trần Văn Cường","Trần Văn Dũng","Trần Văn Đức","Trần Văn Hùng","Trần Văn Khánh","Trần Văn Lâm","Trần Văn Long","Trần Văn Minh",
"Trần Văn Nam","Trần Văn Phát","Trần Văn Quân","Trần Văn Quang","Trần Văn Sơn","Trần Văn Tài","Trần Văn Thắng","Trần Văn Toàn","Trần Văn Trung","Trần Văn Tuấn",
"Trần Văn Vinh","Trần Văn Vũ","Trần Văn Việt","Trần Văn Hòa","Trần Văn Kiên","Trần Văn Đạt","Trần Văn Hiếu","Trần Văn Hiệp","Trần Văn Hải","Trần Văn Thái",
"Trần Văn Hạnh","Trần Văn Hảo","Trần Văn Bảo","Trần Văn Phúc","Trần Văn Khoa","Trần Văn Lộc","Trần Văn Thọ","Trần Văn Thành","Trần Thị An","Trần Thị Bình",
"Trần Thị Cúc","Trần Thị Dung","Trần Thị Đào","Trần Thị Hạnh","Trần Thị Hằng","Trần Thị Hoa","Trần Thị Hồng","Trần Thị Huệ","Trần Thị Lan","Trần Thị Lý",
"Trần Thị Mai","Trần Thị Nga","Trần Thị Ngọc","Trần Thị Nhàn","Trần Thị Nhung","Trần Thị Phương","Trần Thị Quỳnh","Trần Thị Thảo","Trần Thị Thu","Trần Thị Thủy",
"Trần Thị Tuyết","Trần Thị Vân","Trần Thị Yến","Trần Thị Hương","Trần Thị Tâm","Trần Thị Thanh","Trần Thị Trinh","Trần Thị Trúc"
];
const PROVINCES = [
    "Hà Nội", "TP.HCM", "Đà Nẵng", "Gia Lai", "Cần Thơ"
];
const PRODUCTS = [
    {name: "Gói Basic", price: "400.000 VND"},
    {name: "Gói VIP1", price: "600.000 VND"},
    {name: "Gói VIP2", price: "800.000 VND"},
    {name: "Gói VIP3", price: "3.000.000 VND"}
];

function randomItem(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
}

function createNotifyHTML() {
    const name = randomItem(NAMES);
    const province = randomItem(PROVINCES);
    // Muốn chỉ hiện Gói Basic thì để const product = PRODUCTS[0];
    const product = randomItem(PRODUCTS);

    return `
    <div style="
        display:flex;
        align-items:center;
        background:rgba(0,0,0,0.85);
        color:#fff;
        border-radius:8px;
        box-shadow:0 2px 12px rgba(0,0,0,.2);
        padding:12px 20px 12px 12px;
        position:fixed;
        left:20px;
        bottom:30px;
        z-index:9999;
        min-width:260px;
        font-size:1rem;
        animation: fadeIn 0.5s;
    ">
        <i class="fa-solid fa-bell" style="color:#f72585;font-size:1.4rem;margin-right:12px"></i>
        <div>
            <b>${name}</b> (${province}) vừa mua <span style="color:#4cc9f0;font-weight:600">${product.name}</span> <br>
            <span style="font-size:0.95em;color:#fff9;">Giá: <b>${product.price}</b></span>
        </div>
    </div>
    `;
}

function showNotify() {
    const html = createNotifyHTML();
    const div = document.createElement('div');
    div.innerHTML = html;
    div.style.position = 'fixed'; // redundancy for safety
    document.body.appendChild(div);

    setTimeout(() => {
        div.style.transition = 'opacity 0.6s';
        div.style.opacity = 0;
        setTimeout(() => {
            document.body.removeChild(div);
        }, 600);
    }, 6000);
}

function startRandomNotify(intervalMs = 30000) {
    setTimeout(function loop() {
        showNotify();
        setTimeout(loop, intervalMs + Math.floor(Math.random() * 4000) - 2000);
    }, 2000 + Math.random() * 2000);
}

startRandomNotify();
</script>

    <!-- Anti-view-source helper (không tuyệt đối, chỉ làm khó người dùng bình thường) -->
<script>
(function(){
  // disable right click
  document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
    // optionally show message
    // alert('Chuột phải đã bị vô hiệu hóa.');
    return false;
  }, {capture: true, passive: false});

  // disable text selection, drag, copy, cut
  document.addEventListener('selectstart', e => e.preventDefault(), {capture:true});
  document.addEventListener('dragstart', e => e.preventDefault(), {capture:true});
  document.addEventListener('copy', e => e.preventDefault(), {capture:true});
  document.addEventListener('cut', e => e.preventDefault(), {capture:true});

  // intercept common "view source" / devtools shortcuts
  window.addEventListener('keydown', function(e) {
    // F12
    if (e.key === 'F12') { e.preventDefault(); e.stopPropagation(); return false; }

    // Ctrl+Shift+I / J / C  or Ctrl+Shift+C
    if (e.ctrlKey && e.shiftKey && ['I','J','C'].includes(e.key.toUpperCase())) {
      e.preventDefault(); e.stopPropagation(); return false;
    }

    // Ctrl+U (view-source)
    if (e.ctrlKey && !e.shiftKey && e.key.toUpperCase() === 'U') {
      e.preventDefault(); e.stopPropagation(); return false;
    }

    // Ctrl+S / Ctrl+P (save/print page)
    if (e.ctrlKey && ['S','P'].includes(e.key.toUpperCase())) {
      e.preventDefault(); e.stopPropagation(); return false;
    }
  }, {capture:true});

  // Optional: detect when devtools opened (heuristic)
  // This uses small timing hack / dimension check. It's not reliable.
  var devtoolsOpen = false;
  var element = new Image();
  Object.defineProperty(element, 'id', {
    get: function () {
      devtoolsOpen = true;
      // do something if opened
      // e.g., redirect or show overlay:
      // window.location.href = 'about:blank';
      return '';
    }
  });
  setInterval(function () {
    devtoolsOpen = false;
    console.log(element);
    if (devtoolsOpen) {
      // action when devtools detected (be careful with UX)
      // show overlay as gentle deterrent
      if(!document.getElementById('devtools-overlay')) {
        var ov = document.createElement('div');
        ov.id = 'devtools-overlay';
        ov.style.position = 'fixed';
        ov.style.top = 0;
        ov.style.left = 0;
        ov.style.width = '100%';
        ov.style.height = '100%';
        ov.style.background = 'rgba(0,0,0,0.85)';
        ov.style.color = '#fff';
        ov.style.zIndex = 99999;
        ov.style.display = 'flex';
        ov.style.alignItems = 'center';
        ov.style.justifyContent = 'center';
        ov.style.fontSize = '20px';
        ov.innerText = 'DevTools detected — trang bị giới hạn tạm thời.';
        document.body.appendChild(ov);
      }
    } else {
      var o = document.getElementById('devtools-overlay');
      if (o) o.remove();
    }
  }, 1000);
})();
</script>

</body>
</html>
